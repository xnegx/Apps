<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decodificador de CSR</title>
</head>
<body>
    <h1>Visualizador de Header</h1>

    <!-- Formul√°rio de upload de arquivo bin√°rio e certificados -->
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <label for="binary_file">Envie o arquivo bin√°rio:</label>
        <input type="file" name="binary_file" accept="*/*" required><br><br>

        <label for="cert_origin">Envie o certificado de origem (opcional):</label>
        <input type="file" name="cert_origin" accept=".pem, .der, .cer"><br><br>

        <label for="cert_destination">Envie o certificado de destino (opcional):</label>
        <input type="file" name="cert_destination" accept=".pem, .der, .cer"><br><br>

        <button type="submit">Enviar</button>
    </form>

    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    {% if parsed_data %}
        <h2>Informa√ß√µes do Cabe√ßalho Decodificado:</h2>
        <ul>
            {% for field, value in parsed_data.items %}
                <li><strong>{{ field }}:</strong> {{ value }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    {% if cert_verification %}
        <h2>Resultado da Compara√ß√£o dos Certificados</h2>
        <ul>
            <li><strong>Certificado de Origem do Arquivo:</strong>
                {% if cert_verification.certificado_origem %}
                    ‚úÖ
                {% else %}
                    ‚ùå
                {% endif %}
            </li>

            <li><strong>Certificado de Destino do Arquivo:</strong>
                {% if cert_verification.certificado_destino %}
                    ‚úÖ
                {% else %}
                    ‚ùå
                {% endif %}
            </li>

            <li><strong>Emissor de Origem:</strong> {{ cert_verification.emissor_origem }}</li>
            <li><strong>Emissor de Destino:</strong> {{ cert_verification.emissor_destino }}</li>
            <li><strong>S√©rie do Certificado de Origem:</strong> {{ cert_verification.serie_origem }}</li>
            <li><strong>S√©rie do Certificado de Destino:</strong> {{ cert_verification.serie_destino }}</li>
        </ul>
    {% endif %}
    {% if certificados_encontrados.origem or certificados_encontrados.destino %}
        <h2>Certificados Encontrados no Banco de Dados</h2>
        <ul>

            {% if certificados_encontrados.origem %}
                <li>
                    <strong>Certificado de Origem:</strong> {{ certificados_encontrados.origem.nome }}
                    (<a href="{% url 'download_certificado' certificados_encontrados.origem.id %}" download>üì• Baixar Certificado de Origem</a>)
                </li>
            {% endif %}
            {% if certificados_encontrados.destino %}
                <li>
                    <strong>Certificado de Destino:</strong> {{ certificados_encontrados.destino.nome }}
                    (<a href="{% url 'download_certificado' certificados_encontrados.destino.id %}" download>üì• Baixar Certificado de Destino</a>)
                </li>
            {% endif %}




        </ul>
    {% endif %}


</body>
</html>
